KISSY.Editor.add("htmlparser",function(){function i(){this._={htmlPartsRegex:RegExp("<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)--\>)|(?:([^\\s>]+)\\s*((?:(?:[^\"'>]+)|(?:\"[^\"]*\")|(?:'[^']*'))*)\\/?>))","g")}}var g=KISSY.Editor;if(!g.HtmlParser){var l=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,m={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},j=g.XHTML_DTD;KISSY.augment(i,{onTagOpen:function(){},
onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(f){for(var b,a,d=0,c;b=this._.htmlPartsRegex.exec(f);){a=b.index;if(a>d){d=f.substring(d,a);c?c.push(d):this.onText(d)}d=this._.htmlPartsRegex.lastIndex;if(a=b[1]){a=a.toLowerCase();if(c&&j.$cdata[a]){this.onCDATA(c.join(""));c=null}if(!c){this.onTagClose(a);continue}}if(c)c.push(b[0]);else if(a=b[3]){a=a.toLowerCase();var k={},e;b=b[4];var n=!!(b&&b.charAt(b.length-1)=="/");if(b)for(;e=l.exec(b);){var h=
e[1].toLowerCase();e=e[2]||e[3]||e[4]||"";k[h]=!e&&m[h]?h:e}this.onTagOpen(a,k,n);if(!c&&j.$cdata[a])c=[]}else if(a=b[2])this.onComment(a)}f.length>d&&this.onText(f.substring(d,f.length))}});g.HtmlParser=i}});
